(window.webpackJsonp=window.webpackJsonp||[]).push([[222],{581:function(e,a,s){"use strict";s.r(a);var t=s(43),r=Object(t.a)({},(function(){var e=this,a=e.$createElement,s=e._self._c||a;return s("ContentSlotsDistributor",{attrs:{"slot-key":e.$parent.slotKey}},[s("div",{staticClass:"custom-block tip"},[s("p",{staticClass:"custom-block-title"},[e._v("TIP")]),e._v(" "),s("p",[e._v("ðŸ”¥ Make sure you "),s("a",{attrs:{href:"https://github.com/Microsoft/AzureTipsAndTricks?WT.mc_id=azure-azuredevtips-azureappsdev",target:"_blank",rel:"noopener noreferrer"}},[e._v("star the repo"),s("OutboundLink")],1),e._v(" to keep up to date with new tips and tricks.")]),e._v(" "),s("p",[e._v("ðŸ’¡ Learn more : "),s("a",{attrs:{href:"https://docs.microsoft.com/azure/cosmos-db/?WT.mc_id=docs-azuredevtips-azureappsdev",target:"_blank",rel:"noopener noreferrer"}},[e._v("Azure Cosmos DB documentation"),s("OutboundLink")],1),e._v(".")]),e._v(" "),s("p",[e._v("ðŸ“º Watch the video : "),s("a",{attrs:{href:"https://youtu.be/xzBhbq--4UU?WT.mc_id=youtube-azuredevtips-azureappsdev",target:"_blank",rel:"noopener noreferrer"}},[e._v("How to work with Azure Cosmos DB with PowerShell"),s("OutboundLink")],1),e._v(".")])]),e._v(" "),s("h3",{attrs:{id:"how-to-work-with-azure-cosmos-db-with-powershell"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#how-to-work-with-azure-cosmos-db-with-powershell"}},[e._v("#")]),e._v(" How to work with Azure Cosmos DB with PowerShell")]),e._v(" "),s("h4",{attrs:{id:"azure-cosmos-db"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#azure-cosmos-db"}},[e._v("#")]),e._v(" Azure Cosmos DB")]),e._v(" "),s("p",[s("a",{attrs:{href:"https://azure.microsoft.com/services/cosmos-db/?WT.mc_id=azure-azuredevtips-azureappsdev",target:"_blank",rel:"noopener noreferrer"}},[e._v("Azure Cosmos DB"),s("OutboundLink")],1),e._v(" is a document database that you can use with multiple APIs, including a "),s("a",{attrs:{href:"https://docs.microsoft.com/azure/cosmos-db/sql-api-get-started?WT.mc_id=docs-azuredevtips-azureappsdev",target:"_blank",rel:"noopener noreferrer"}},[e._v("SQL API"),s("OutboundLink")],1),e._v(", a "),s("a",{attrs:{href:"https://docs.microsoft.com/azure/cosmos-db/tutorial-develop-mongodb-nodejs?WT.mc_id=docs-azuredevtips-azureappsdev",target:"_blank",rel:"noopener noreferrer"}},[e._v("MongoDB API"),s("OutboundLink")],1),e._v(" and a "),s("a",{attrs:{href:"https://docs.microsoft.com/azure/cosmos-db/create-graph-dotnet?WT.mc_id=docs-azuredevtips-azureappsdev",target:"_blank",rel:"noopener noreferrer"}},[e._v("Graph API"),s("OutboundLink")],1),e._v(". And Cosmos BD is also geographically highly performant because it can have multiple writable nodes spread across the world. You can create and manage an Azure Cosmos DB in the "),s("a",{attrs:{href:"https://docs.microsoft.com/azure/cosmos-db/create-cosmosdb-resources-portal?WT.mc_id=docs-azuredevtips-azureappsdev",target:"_blank",rel:"noopener noreferrer"}},[e._v("Azure portal"),s("OutboundLink")],1),e._v(", with the "),s("a",{attrs:{href:"https://docs.microsoft.com/azure/cosmos-db/cli-samples?WT.mc_id=docs-azuredevtips-azureappsdev",target:"_blank",rel:"noopener noreferrer"}},[e._v("Azure CLI"),s("OutboundLink")],1),e._v(" and also with "),s("a",{attrs:{href:"https://docs.microsoft.com/azure/cosmos-db/manage-with-powershell?WT.mc_id=docs-azuredevtips-azureappsdev",target:"_blank",rel:"noopener noreferrer"}},[e._v("PowerShell"),s("OutboundLink")],1),e._v(".")]),e._v(" "),s("p",[e._v("In this post, we'll take a look at how to manage an Azure Cosmos DB with PowerShell.")]),e._v(" "),s("h4",{attrs:{id:"prerequisites"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#prerequisites"}},[e._v("#")]),e._v(" Prerequisites")]),e._v(" "),s("p",[e._v("If you want to follow along, you'll need the following:")]),e._v(" "),s("ul",[s("li",[e._v("An Azure subscription (If you don't have an Azure subscription, create a "),s("a",{attrs:{href:"https://azure.microsoft.com/free/?WT.mc_id=azure-azuredevtips-azureappsdev",target:"_blank",rel:"noopener noreferrer"}},[e._v("free account"),s("OutboundLink")],1),e._v(" before you begin)")]),e._v(" "),s("li",[e._v("You can use the "),s("a",{attrs:{href:"https://shell.azure.com/?WT.mc_id=azure-azuredevtips-azureappsdev",target:"_blank",rel:"noopener noreferrer"}},[e._v("Azure Cloud Shell"),s("OutboundLink")],1),e._v(" or your "),s("a",{attrs:{href:"https://docs.microsoft.com/azure/powershell-install-configure?WT.mc_id=docs-azuredevtips-azureappsdev",target:"_blank",rel:"noopener noreferrer"}},[e._v("local PowerShell"),s("OutboundLink")],1)])]),e._v(" "),s("h4",{attrs:{id:"using-powershell-to-manage-azure-cosmos-db"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#using-powershell-to-manage-azure-cosmos-db"}},[e._v("#")]),e._v(" Using PowerShell to manage Azure Cosmos DB")]),e._v(" "),s("p",[e._v("You can use PowerShell to create, update, delete and work with Azure Cosmos DB. Let's create a new Cosmos DB account, a database and container with PowerShell. We'll use the Azure Cloud Shell, and you can also use a local installation of Azure PowerShell.")]),e._v(" "),s("p",[s("strong",[e._v("Install the Az.CosmosDB module")])]),e._v(" "),s("p",[e._v("Before we can work with Azure Cosmos DB from PowerShell, we need to install the "),s("a",{attrs:{href:"https://docs.microsoft.com/powershell/module/az.cosmosdb/?WT.mc_id=docs-azuredevtips-azureappsdev",target:"_blank",rel:"noopener noreferrer"}},[e._v("Az.CosmosDB module"),s("OutboundLink")],1),e._v(". To install this, execute the following command in PowerShell:")]),e._v(" "),s("div",{staticClass:"language- line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[e._v("Install-Module -Name Az.CosmosDB\n")])]),e._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[e._v("1")]),s("br")])]),s("img",{attrs:{src:e.$withBase("/files/82installmodule.png")}}),e._v(" "),s("p",[e._v("(Install Az.CosmosDB module)")]),e._v(" "),s("p",[s("strong",[e._v("List all Cosmos DB accounts")])]),e._v(" "),s("p",[e._v("When the module is installed, we can use it. Let's try it out by listing all Cosmos DB accounts in a Resource Group with the following command:")]),e._v(" "),s("div",{staticClass:"language- line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[e._v('Get-AzCosmosDBAccount -ResourceGroupName "azuretipsandtricks"\n')])]),e._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[e._v("1")]),s("br")])]),s("p",[s("strong",[e._v("Create an Azure Cosmos DB Account")]),e._v("\nLet's create a new Azure Cosmos DB account. This account can contain databases and those can contain containers. We'll start by creating the account with the following command. This account will use the SQL API to work with data.")]),e._v(" "),s("div",{staticClass:"language- line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[e._v('$resourceGroupName = "azuretipsandtricks"\n$locations = @("West US 2", "East US 2")\n$accountName = "mytipscosmosaccount"\n$apiKind = "Sql"\n$consistencyLevel = "BoundedStaleness"\n$maxStalenessInterval = 300\n$maxStalenessPrefix = 100000\n\nNew-AzCosmosDBAccount `\n    -ResourceGroupName $resourceGroupName `\n    -Location $locations `\n    -Name $accountName `\n    -ApiKind $apiKind `\n    -EnableAutomaticFailover:$true `\n    -DefaultConsistencyLevel $consistencyLevel `\n    -MaxStalenessIntervalInSeconds $maxStalenessInterval `\n    -MaxStalenessPrefix $maxStalenessPrefix\n')])]),e._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[e._v("1")]),s("br"),s("span",{staticClass:"line-number"},[e._v("2")]),s("br"),s("span",{staticClass:"line-number"},[e._v("3")]),s("br"),s("span",{staticClass:"line-number"},[e._v("4")]),s("br"),s("span",{staticClass:"line-number"},[e._v("5")]),s("br"),s("span",{staticClass:"line-number"},[e._v("6")]),s("br"),s("span",{staticClass:"line-number"},[e._v("7")]),s("br"),s("span",{staticClass:"line-number"},[e._v("8")]),s("br"),s("span",{staticClass:"line-number"},[e._v("9")]),s("br"),s("span",{staticClass:"line-number"},[e._v("10")]),s("br"),s("span",{staticClass:"line-number"},[e._v("11")]),s("br"),s("span",{staticClass:"line-number"},[e._v("12")]),s("br"),s("span",{staticClass:"line-number"},[e._v("13")]),s("br"),s("span",{staticClass:"line-number"},[e._v("14")]),s("br"),s("span",{staticClass:"line-number"},[e._v("15")]),s("br"),s("span",{staticClass:"line-number"},[e._v("16")]),s("br"),s("span",{staticClass:"line-number"},[e._v("17")]),s("br")])]),s("p",[s("strong",[e._v("Create an Azure Cosmos DB database")])]),e._v(" "),s("p",[e._v("When the account is created, we can create a database in it with the following command:")]),e._v(" "),s("div",{staticClass:"language- line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[e._v('$resourceGroupName = "azuretipsandtricks"\n$accountName = "mytipscosmosaccount"\n$databaseName = "tipsDatabase"\n\nNew-AzCosmosDBSqlDatabase `\n    -ResourceGroupName $resourceGroupName `\n    -AccountName $accountName `\n    -Name $databaseName\n')])]),e._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[e._v("1")]),s("br"),s("span",{staticClass:"line-number"},[e._v("2")]),s("br"),s("span",{staticClass:"line-number"},[e._v("3")]),s("br"),s("span",{staticClass:"line-number"},[e._v("4")]),s("br"),s("span",{staticClass:"line-number"},[e._v("5")]),s("br"),s("span",{staticClass:"line-number"},[e._v("6")]),s("br"),s("span",{staticClass:"line-number"},[e._v("7")]),s("br"),s("span",{staticClass:"line-number"},[e._v("8")]),s("br")])]),s("p",[s("strong",[e._v("Create an Azure Cosmos DB Container with Autoscale")])]),e._v(" "),s("p",[e._v("And in the database, we can create a container, which we can use to store documents. We'll create the container with autoscale enabled with this command:")]),e._v(" "),s("div",{staticClass:"language- line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[e._v('# Create an Azure Cosmos DB container with default indexes and autoscale throughput at 4000 RU\n$resourceGroupName = "azuretipsandtricks"\n$accountName = "mytipscosmosaccount"\n$databaseName = "tipsDatabase"\n$containerName = "tricksContainer"\n$partitionKeyPath = "/myPartitionKey"\n$autoscaleMaxThroughput = 4000 #minimum = 4000\n\nNew-AzCosmosDBSqlContainer `\n    -ResourceGroupName $resourceGroupName `\n    -AccountName $accountName `\n    -DatabaseName $databaseName `\n    -Name $containerName `\n    -PartitionKeyKind Hash `\n    -PartitionKeyPath $partitionKeyPath `\n    -AutoscaleMaxThroughput $autoscaleMaxThroughput\n')])]),e._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[e._v("1")]),s("br"),s("span",{staticClass:"line-number"},[e._v("2")]),s("br"),s("span",{staticClass:"line-number"},[e._v("3")]),s("br"),s("span",{staticClass:"line-number"},[e._v("4")]),s("br"),s("span",{staticClass:"line-number"},[e._v("5")]),s("br"),s("span",{staticClass:"line-number"},[e._v("6")]),s("br"),s("span",{staticClass:"line-number"},[e._v("7")]),s("br"),s("span",{staticClass:"line-number"},[e._v("8")]),s("br"),s("span",{staticClass:"line-number"},[e._v("9")]),s("br"),s("span",{staticClass:"line-number"},[e._v("10")]),s("br"),s("span",{staticClass:"line-number"},[e._v("11")]),s("br"),s("span",{staticClass:"line-number"},[e._v("12")]),s("br"),s("span",{staticClass:"line-number"},[e._v("13")]),s("br"),s("span",{staticClass:"line-number"},[e._v("14")]),s("br"),s("span",{staticClass:"line-number"},[e._v("15")]),s("br"),s("span",{staticClass:"line-number"},[e._v("16")]),s("br")])]),s("p",[e._v("And that's it! Head on over to the Azure portal to see the Azure Cosmos DB. In the Data Explorer, you will see the database and container that we've created.")]),e._v(" "),s("img",{attrs:{src:e.$withBase("/files/82cosmosresult.png")}}),e._v(" "),s("p",[e._v("(Cosmos DB result in the Azure portal)")]),e._v(" "),s("h4",{attrs:{id:"conclusion"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#conclusion"}},[e._v("#")]),e._v(" Conclusion")]),e._v(" "),s("p",[e._v("We've "),s("a",{attrs:{href:"https://docs.microsoft.com/azure/cosmos-db/manage-with-powershell?WT.mc_id=docs-azuredevtips-azureappsdev",target:"_blank",rel:"noopener noreferrer"}},[e._v("used PowerShell"),s("OutboundLink")],1),e._v(" to list "),s("a",{attrs:{href:"https://azure.microsoft.com/services/cosmos-db/?WT.mc_id=azure-azuredevtips-azureappsdev",target:"_blank",rel:"noopener noreferrer"}},[e._v("Azure Cosmos DB"),s("OutboundLink")],1),e._v(" accounts and create a new one, with a database and autoscale container. Go and check it out!")])])}),[],!1,null,null,null);a.default=r.exports}}]);