(window.webpackJsonp=window.webpackJsonp||[]).push([[227],{663:function(e,t,r){"use strict";r.r(t);var o=r(69),n=Object(o.a)({},(function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("ContentSlotsDistributor",{attrs:{"slot-key":e.$parent.slotKey}},[r("div",{staticClass:"custom-block tip"},[r("p",{staticClass:"custom-block-title"},[e._v("TIP")]),e._v(" "),r("p",[e._v("ðŸ”¥  Help shape the future of Azure Tips and Tricks by telling what you'd like for us to write about "),r("a",{attrs:{href:"https://github.com/microsoft/AzureTipsAndTricks/issues/new?assignees=&labels=&template=survey.md&title=",target:"_blank",rel:"noopener noreferrer"}},[e._v("here"),r("OutboundLink")],1),e._v(".")]),e._v(" "),r("p",[e._v("ðŸ’¡ Learn more : "),r("a",{attrs:{href:"https://microsoft.github.io/AzureTipsAndTricks/blog/tip236.html?WT.mc_id=github-azuredevtips-azureappsdev",target:"_blank",rel:"noopener noreferrer"}},[e._v("Tip 236 Deploy your web app in Windows Containers on Azure App Service"),r("OutboundLink")],1),e._v(".")]),e._v(" "),r("p",[e._v("ðŸ“º Watch the video : "),r("a",{attrs:{href:"https://youtu.be/5rR5C4Z5dU4?WT.mc_id=youtube-azuredevtips-azureappsdev",target:"_blank",rel:"noopener noreferrer"}},[e._v("How to use Deployment Slots in Azure App Service for Containers"),r("OutboundLink")],1),e._v(".")])]),e._v(" "),r("h3",{attrs:{id:"how-to-use-deployment-slots-in-azure-app-service-for-containers"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#how-to-use-deployment-slots-in-azure-app-service-for-containers"}},[e._v("#")]),e._v(" How to use Deployment Slots in Azure App Service for Containers")]),e._v(" "),r("h4",{attrs:{id:"managed-features-for-containerized-applications"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#managed-features-for-containerized-applications"}},[e._v("#")]),e._v(" Managed features for containerized applications")]),e._v(" "),r("p",[e._v("Using containers is a great way to make sure that your application can run anywhere and that it runs in the same environment, anywhere. In Azure, you can run containers in many services, including in "),r("a",{attrs:{href:"https://azure.microsoft.com/services/kubernetes-service/?WT.mc_id=azure-azuredevtips-azureappsdev",target:"_blank",rel:"noopener noreferrer"}},[e._v("Azure Kubernetes Service"),r("OutboundLink")],1),e._v(", "),r("a",{attrs:{href:"https://azure.microsoft.com/services/container-instances/?WT.mc_id=azure-azuredevtips-azureappsdev",target:"_blank",rel:"noopener noreferrer"}},[e._v("Azure Container Instances"),r("OutboundLink")],1),e._v(", "),r("a",{attrs:{href:"https://azure.microsoft.com/services/service-fabric/?WT.mc_id=azure-azuredevtips-azureappsdev",target:"_blank",rel:"noopener noreferrer"}},[e._v("Azure Service Fabric"),r("OutboundLink")],1),e._v(" and more. And you can also run containers in "),r("a",{attrs:{href:"https://azure.microsoft.com/services/app-service/?WT.mc_id=azure-azuredevtips-azureappsdev",target:"_blank",rel:"noopener noreferrer"}},[e._v("Azure App Service"),r("OutboundLink")],1),e._v(". Running containers in Azure App Service enables you to use features like "),r("a",{attrs:{href:"https://docs.microsoft.com/azure/app-service/deploy-staging-slots?WT.mc_id=docs-azuredevtips-azureappsdev",target:"_blank",rel:"noopener noreferrer"}},[e._v("deployment slots"),r("OutboundLink")],1),e._v(" and easy "),r("a",{attrs:{href:"https://docs.microsoft.com/azure/app-service/overview-authentication-authorization",target:"_blank",rel:"noopener noreferrer"}},[e._v("authentication and authorization"),r("OutboundLink")],1),e._v(".")]),e._v(" "),r("p",[e._v("In this post, we'll take a look at using deployment slots for containers in Azure App Service.")]),e._v(" "),r("h4",{attrs:{id:"prerequisites"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#prerequisites"}},[e._v("#")]),e._v(" Prerequisites")]),e._v(" "),r("p",[e._v("If you want to follow along, you'll need the following:")]),e._v(" "),r("ul",[r("li",[e._v("An Azure subscription (If you don't have an Azure subscription, create a "),r("a",{attrs:{href:"https://azure.microsoft.com/free/?WT.mc_id=azure-azuredevtips-azureappsdev",target:"_blank",rel:"noopener noreferrer"}},[e._v("free account"),r("OutboundLink")],1),e._v(" before you begin)")]),e._v(" "),r("li",[r("a",{attrs:{href:"https://microsoft.github.io/AzureTipsAndTricks/blog/tip236.html?WT.mc_id=github-azuredevtips-azureappsdev",target:"_blank",rel:"noopener noreferrer"}},[e._v("Follow the instruction in Tip 236"),r("OutboundLink")],1),e._v(", to deploy an ASP.NET Forms application in a WIndows container to Azure App Service")])]),e._v(" "),r("h4",{attrs:{id:"using-deployment-slots"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#using-deployment-slots"}},[e._v("#")]),e._v(" Using deployment slots")]),e._v(" "),r("p",[r("a",{attrs:{href:"https://docs.microsoft.com/azure/app-service/deploy-staging-slots?WT.mc_id=docs-azuredevtips-azureappsdev",target:"_blank",rel:"noopener noreferrer"}},[e._v("Deployment slots"),r("OutboundLink")],1),e._v(" in Azure App Service help you to deploy new features of your app without any downtime. Let's see how we can do that with a containerized application. We'll start with an ASP.NET app that is already containerized and deployed to an Azure App Service.")]),e._v(" "),r("ol",[r("li",[e._v("Go to the "),r("a",{attrs:{href:"https://portal.azure.com/?WT.mc_id=azure-azuredevtips-azureappsdev",target:"_blank",rel:"noopener noreferrer"}},[e._v("Azure portal"),r("OutboundLink")],1)]),e._v(" "),r("li",[e._v("Navigate to the Azure App Service")]),e._v(" "),r("li",[e._v("In the overview blade, click on "),r("strong",[e._v("Browse")]),e._v(" to see the application that is running in a container in the App Service.")])]),e._v(" "),r("img",{attrs:{src:e.$withBase("/files/90result1.png")}}),e._v(" "),r("p",[e._v("(Application running in App Service)")]),e._v(" "),r("ol",{attrs:{start:"4"}},[r("li",[e._v("The App Service gets the container from "),r("a",{attrs:{href:"https://hub.docker.com/?WT.mc_id=other-azuredevtips-azureappsdev",target:"_blank",rel:"noopener noreferrer"}},[e._v("Docker Hub"),r("OutboundLink")],1),e._v(", and you can also use "),r("a",{attrs:{href:"https://azure.microsoft.com/services/container-registry/?WT.mc_id=azure-azuredevtips-azureappsde",target:"_blank",rel:"noopener noreferrer"}},[e._v("Azure Container Registry"),r("OutboundLink")],1),e._v(". We are going to change the application, publish a new version of the container image to the container registry and deploy that to a deployment slot. Open The application in "),r("strong",[e._v("Visual Studio")]),e._v(" and make a visible change to it")]),e._v(" "),r("li",[e._v("In Visual Studio, "),r("strong",[e._v("right-click the project file")]),e._v(" and click "),r("strong",[e._v("Publish")])]),e._v(" "),r("li",[e._v("In the Publish window, change the "),r("strong",[e._v("Image Tag")]),e._v(' to something else than "latest"')]),e._v(" "),r("li",[e._v("Click "),r("strong",[e._v("Publish")]),e._v(" to publish the new version of the application in a container to the container registry")])]),e._v(" "),r("img",{attrs:{src:e.$withBase("/files/90publishwithtag.png")}}),e._v(" "),r("p",[e._v("(Publish window in Visual Studio)")]),e._v(" "),r("ol",{attrs:{start:"8"}},[r("li",[e._v("Go back to the Azure portal and back to the App Service")]),e._v(" "),r("li",[e._v("Select the "),r("strong",[e._v("Deployment slots")]),e._v(" menu")]),e._v(" "),r("li",[e._v("We currently have no deployment slots, so let's add one by clicking on "),r("strong",[e._v("Add Slot")])]),e._v(" "),r("li",[e._v("Provide a "),r("strong",[e._v("name")]),e._v(" for the deployment slot")]),e._v(" "),r("li",[e._v("Click "),r("strong",[e._v("Add")])]),e._v(" "),r("li",[e._v("You'll now see the new slot in the list of deployment slots. Click on it")]),e._v(" "),r("li",[e._v("When the deployment slot is opened, it looks exactly the same as the App Service. That is because a deployment slot is another instance of an App Service that runs in the same "),r("a",{attrs:{href:"https://docs.microsoft.com/azure/app-service/overview-hosting-plans?WT.mc_id=docs-azuredevtips-azureappsdev",target:"_blank",rel:"noopener noreferrer"}},[e._v("App Service Plan"),r("OutboundLink")],1),e._v(". This means that you can use almost all App Service features in a deployment slot and that you don't pay extra for it. Go to the "),r("strong",[e._v("Container settings")]),e._v(" menu in the deployment slot")]),e._v(" "),r("li",[e._v("In Container Settings, change the "),r("strong",[e._v("Full Image Name and Tag")]),e._v(", so that it points to the latest version of the application")]),e._v(" "),r("li",[e._v("Click "),r("strong",[e._v("Save")])]),e._v(" "),r("li",[e._v("Go back to the "),r("strong",[e._v("Overview")]),e._v("  blade and click "),r("strong",[e._v("Restart")]),e._v(" to restart the App Service. Now wait a few minutes and click "),r("strong",[e._v("Browse")]),e._v(" to see the new version of the app in action")])]),e._v(" "),r("img",{attrs:{src:e.$withBase("/files/90result2.png")}}),e._v(" "),r("p",[e._v("(New version of the app in a deployment slot)")]),e._v(" "),r("p",[e._v("The new version of the application runs in a deployment slot. The slot has almost the same URL as the original App Service (the "),r("strong",[e._v("production")]),e._v(" slot), only appended with the slot name, like "),r("strong",[e._v("container-tricks-staging.azurewebsites.net")])]),e._v(" "),r("ol",{attrs:{start:"18"}},[r("li",[e._v("Now for the magic part of deployment slots, the swap. Go to the "),r("strong",[e._v("Deployment slots")]),e._v(" menu again")]),e._v(" "),r("li",[e._v("Click on the "),r("strong",[e._v("Swap")]),e._v(" button")]),e._v(" "),r("li",[e._v("Leave everything as it is and click "),r("strong",[e._v("Swap")]),e._v('. This will warm up the staging slot and "swap" it with the production slot, to seamlessly deploy the new version of the application to production, without any downtime')])]),e._v(" "),r("img",{attrs:{src:e.$withBase("/files/90swap.png")}}),e._v(" "),r("p",[e._v("(Swap deployment slots)")]),e._v(" "),r("ol",{attrs:{start:"21"}},[r("li",[e._v("In the Deployment slot blade, click on the "),r("strong",[e._v("production slot")])]),e._v(" "),r("li",[e._v("Click on "),r("strong",[e._v("Browse")]),e._v(" in the overview blade to see the app that is running in production")])]),e._v(" "),r("img",{attrs:{src:e.$withBase("/files/90result3.png")}}),e._v(" "),r("p",[e._v("(New version of the app in production)")]),e._v(" "),r("p",[e._v("The latest version of the app is now running in production. If you check the deployment slot, you'll find that it is now running the old version of the app. This allows you to easily revert a deployment, by simply swapping back.")]),e._v(" "),r("h4",{attrs:{id:"conclusion"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#conclusion"}},[e._v("#")]),e._v(" Conclusion")]),e._v(" "),r("p",[r("a",{attrs:{href:"https://docs.microsoft.com/azure/app-service/deploy-staging-slots?WT.mc_id=docs-azuredevtips-azureappsdev",target:"_blank",rel:"noopener noreferrer"}},[e._v("Deployment slots"),r("OutboundLink")],1),e._v(" are a powerful feature of "),r("a",{attrs:{href:"https://azure.microsoft.com/services/app-service/?WT.mc_id=azure-azuredevtips-azureappsdev",target:"_blank",rel:"noopener noreferrer"}},[e._v("Azure App Service"),r("OutboundLink")],1),e._v(" that allows you to deploy without any downtime. You can use them for containerized application with "),r("a",{attrs:{href:"https://azure.microsoft.com/services/app-service/containers/?WT.mc_id=azure-azuredevtips-azureappsdev",target:"_blank",rel:"noopener noreferrer"}},[e._v("Azure App Service for Containers"),r("OutboundLink")],1),e._v(". Go and check it out!")])])}),[],!1,null,null,null);t.default=n.exports}}]);