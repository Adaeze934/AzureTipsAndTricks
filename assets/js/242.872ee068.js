(window.webpackJsonp=window.webpackJsonp||[]).push([[242],{602:function(e,r,a){"use strict";a.r(r);var t=a(43),o=Object(t.a)({},(function(){var e=this,r=e.$createElement,a=e._self._c||r;return a("ContentSlotsDistributor",{attrs:{"slot-key":e.$parent.slotKey}},[a("div",{staticClass:"custom-block tip"},[a("p",{staticClass:"custom-block-title"},[e._v("TIP")]),e._v(" "),a("p",[e._v("ðŸ”¥  Checkout the Azure Developer page at "),a("a",{attrs:{href:"https://azure.com/developer?WT.mc_id=azure-azuredevtips-azureappsdev",target:"_blank",rel:"noopener noreferrer"}},[e._v("azure.com/developer"),a("OutboundLink")],1),e._v(".")]),e._v(" "),a("p",[e._v("ðŸ’¡ Learn more : "),a("a",{attrs:{href:"https://azure.microsoft.com/services/postgresql/?WT.mc_id=azure-azuredevtips-azureappsdev",target:"_blank",rel:"noopener noreferrer"}},[e._v("Azure PostgreSQL Databases"),a("OutboundLink")],1),e._v(".")]),e._v(" "),a("p",[e._v("ðŸ“º Watch the video : "),a("a",{attrs:{href:"https://youtu.be/cjBlWWT2_Sk?WT.mc_id=youtube-azuredevtips-azureappsdev",target:"_blank",rel:"noopener noreferrer"}},[e._v("How to develop apps with Azure Database for PostgreSQL using best practices"),a("OutboundLink")],1),e._v(".")])]),e._v(" "),a("h3",{attrs:{id:"how-to-develop-apps-with-azure-database-for-postgresql-using-best-practices"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#how-to-develop-apps-with-azure-database-for-postgresql-using-best-practices"}},[e._v("#")]),e._v(" How to develop apps with Azure Database for PostgreSQL using best practices")]),e._v(" "),a("h4",{attrs:{id:"managed-postgresql-provides-availability-performance-elasticity-and-security"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#managed-postgresql-provides-availability-performance-elasticity-and-security"}},[e._v("#")]),e._v(" Managed PostgreSQL provides availability, performance, elasticity and security")]),e._v(" "),a("p",[e._v("PostgreSQL is a great relational database with lots of features. "),a("a",{attrs:{href:"https://docs.microsoft.com/azure/postgresql/overview?WT.mc_id=docs-azuredevtips-azureappsdev",target:"_blank",rel:"noopener noreferrer"}},[e._v("Azure Database for PostgreSQL"),a("OutboundLink")],1),e._v(" is based on "),a("a",{attrs:{href:"https://www.postgresql.org/?WT.mc_id=other-azuredevtips-azureappsdev",target:"_blank",rel:"noopener noreferrer"}},[e._v("PostgreSQL Community Edition"),a("OutboundLink")],1),e._v(" and offers a managed version of PostgreSQL, which enables elastic scaling, high availability, data protection and more.")]),e._v(" "),a("p",[e._v("You can create incredible applications with Azure Database for PostgreSQL and when you do, it is important to follow "),a("a",{attrs:{href:"https://docs.microsoft.com/azure/postgresql/application-best-practices#configuration-of-application-and-database-resources?WT.mc_id=docs-azuredevtips-azureappsdev",target:"_blank",rel:"noopener noreferrer"}},[e._v("best practices"),a("OutboundLink")],1),e._v(" to optimize security, availability and performance. This post discusses some of the best practices for building an application with Azure Database for PostgreSQL.")]),e._v(" "),a("h4",{attrs:{id:"prerequisites"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#prerequisites"}},[e._v("#")]),e._v(" Prerequisites")]),e._v(" "),a("p",[e._v("If you want to follow along, you'll need the following:")]),e._v(" "),a("ul",[a("li",[e._v("An Azure subscription (If you don't have an Azure subscription, create a "),a("a",{attrs:{href:"https://azure.microsoft.com/free/?WT.mc_id=azure-azuredevtips-azureappsdev",target:"_blank",rel:"noopener noreferrer"}},[e._v("free account"),a("OutboundLink")],1),e._v(" before you begin)")])]),e._v(" "),a("h4",{attrs:{id:"keep-your-postgresql-server-secure"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#keep-your-postgresql-server-secure"}},[e._v("#")]),e._v(" Keep your PostgreSQL server secure")]),e._v(" "),a("p",[e._v("The first best practice is about security. It is important to follow the latest security guidelines to keep your application safe. In Azure Database for PostgreSQL, you can configure security by:")]),e._v(" "),a("ul",[a("li",[e._v("Enabling the PostgreSQL "),a("a",{attrs:{href:"https://docs.microsoft.com/azure/postgresql/concepts-firewall-rules?WT.mc_id=docs-azuredevtips-azureappsdev",target:"_blank",rel:"noopener noreferrer"}},[e._v("server firewall"),a("OutboundLink")],1)]),e._v(" "),a("li",[e._v("Run the PostgreSQL server and your application in a "),a("a",{attrs:{href:"https://docs.microsoft.com/azure/postgresql/concepts-data-access-and-security-vnet?WT.mc_id=docs-azuredevtips-azureappsdev",target:"_blank",rel:"noopener noreferrer"}},[e._v("virtual network"),a("OutboundLink")],1)]),e._v(" "),a("li",[e._v("Use "),a("a",{attrs:{href:"https://docs.microsoft.com/azure/postgresql/concepts-data-access-and-security-private-link?WT.mc_id=docs-azuredevtips-azureappsdev",target:"_blank",rel:"noopener noreferrer"}},[e._v("Azure Private Link"),a("OutboundLink")],1),e._v(" to create a secure link between your application and the PostgreSQL server")]),e._v(" "),a("li",[e._v("Set the "),a("a",{attrs:{href:"https://docs.microsoft.com/azure/postgresql/concepts-ssl-connection-security?WT.mc_id=docs-azuredevtips-azureappsdev",target:"_blank",rel:"noopener noreferrer"}},[e._v("minimum TLS version"),a("OutboundLink")],1),e._v(" of the PostgreSQL server to 1.2")])]),e._v(" "),a("p",[e._v("You can configure security in the Azure Database for PostgreSQL database "),a("strong",[e._v("Connection security blade")]),e._v(".")]),e._v(" "),a("img",{attrs:{src:e.$withBase("/files/98postgresqlsecurity.png")}}),e._v(" "),a("p",[e._v("(Configure PostgreSQL Connection Security)")]),e._v(" "),a("h4",{attrs:{id:"use-environment-variables-for-connection-information"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#use-environment-variables-for-connection-information"}},[e._v("#")]),e._v(" Use environment variables for connection information")]),e._v(" "),a("p",[e._v("When you connect to Azure Database for PostgreSQL from an application, you shouldn't store the connection string (including username and password) in your application code. It is best practice to use environment variables for the connection string. If your application runs in an "),a("a",{attrs:{href:"https://azure.microsoft.com/services/app-service/web/?WT.mc_id=azure-azuredevtips-azureappsdev",target:"_blank",rel:"noopener noreferrer"}},[e._v("Azure App Service Web App"),a("OutboundLink")],1),e._v(", you can have the application read from the environment variables, which you can configure in the "),a("strong",[e._v("Configuration")]),e._v(" menu of the App Service. In there, you can configure connection strings and application settings, without storing them in your application code.")]),e._v(" "),a("p",[e._v("You can even take it a step further and "),a("a",{attrs:{href:"https://microsoft.github.io/AzureTipsAndTricks/blog/tip271.html?WT.mc_id=github-azuredevtips-azureappsdev",target:"_blank",rel:"noopener noreferrer"}},[e._v("store connection string data in Azure Key Vault"),a("OutboundLink")],1),e._v(" and have the application retrieve it from there.")]),e._v(" "),a("img",{attrs:{src:e.$withBase("/files/98variable.png")}}),e._v(" "),a("p",[e._v("(Configure connection strings in Azure App Service)")]),e._v(" "),a("h4",{attrs:{id:"enable-read-replication-to-mitigate-failovers-and-enhance-performance"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#enable-read-replication-to-mitigate-failovers-and-enhance-performance"}},[e._v("#")]),e._v(" Enable read replication to mitigate failovers and enhance performance")]),e._v(" "),a("p",[e._v("If your database server fails for whatever reason, your application becomes unusable. To prevent this from happening, you can increase your application availability, by "),a("a",{attrs:{href:"https://docs.microsoft.com/azure/postgresql/concepts-read-replicas?WT.mc_id=docs-azuredevtips-azureappsdev",target:"_blank",rel:"noopener noreferrer"}},[e._v("creating read replicas of your Azure Database for PostgreSQL"),a("OutboundLink")],1),e._v(". Read replicas are Azure Database for PostgreSQL databases in another geographic region that will have all the data of the original database synchronized to them. When your original database is unavailable, you can change your application to use the replica database and read data from it. You can also upgrade the replica to become a read/write database, so that your application can also write to it, whilst your primary database is still offline.")]),e._v(" "),a("p",[e._v("Additionally, you can use read replicas to enhance geographic performance. You can create read-only replicas in geographic regions where your users are active and where you also deploy another instance of your application. By doing this, the data is close to your users, which improves performance.")]),e._v(" "),a("p",[e._v("You can add replicas in the Azure Database for PostgreSQL database "),a("strong",[e._v("Replication blade")]),e._v(".")]),e._v(" "),a("img",{attrs:{src:e.$withBase("/files/98replica2.png")}}),e._v(" "),a("p",[e._v("(Azure Database for PostgreSQL replicas)")]),e._v(" "),a("h4",{attrs:{id:"use-autovacuum"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#use-autovacuum"}},[e._v("#")]),e._v(" Use autovacuum")]),e._v(" "),a("p",[e._v("By default, when PostgreSQL performs a delete operation, the records are marked for deletion and will be purged later. PostgreSQL purges these records when it performs a vacuum job. If you don't perform vacuum jobs on a regular basis, your database will grow and slow down because of data bloat, suboptimal indexes and increased I/O.")]),e._v(" "),a("p",[e._v("Luckily, you can enable "),a("a",{attrs:{href:"https://docs.microsoft.com/azure/postgresql/howto-optimize-autovacuum?WT.mc_id=docs-azuredevtips-azureappsdev",target:"_blank",rel:"noopener noreferrer"}},[e._v("autovacuum"),a("OutboundLink")],1),e._v(" in Azure Database for PostgreSQL. Autovacuum performs the vacuum job regularly, which cleans up your database and keeps it performant.")]),e._v(" "),a("p",[e._v("To enable the autovacuum feature, navigate to the "),a("strong",[e._v("Server parameters")]),e._v(" blade of the Azure Database for PostgreSQL database and find and turn "),a("strong",[e._v("autovacuum")]),e._v(" to "),a("strong",[e._v("ON")]),e._v(".")]),e._v(" "),a("img",{attrs:{src:e.$withBase("/files/98autovacuum.png")}}),e._v(" "),a("p",[e._v("(Azure Database for PostgreSQL autovacuum setting)")]),e._v(" "),a("h4",{attrs:{id:"monitor-performance-with-the-query-store"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#monitor-performance-with-the-query-store"}},[e._v("#")]),e._v(" Monitor performance with the Query Store")]),e._v(" "),a("p",[e._v("Most managed databases in Azure enable you to monitor and analyze query statistics. This enables you to troubleshoot which queries are fast and which ones are slow and which queries are executed the most. To enable this feature for Azure Database for PostgreSQL, you need to enable the "),a("a",{attrs:{href:"https://docs.microsoft.com/en-us/azure/postgresql/concepts-query-store?WT.mc_id=docs-azuredevtips-azureappsdev",target:"_blank",rel:"noopener noreferrer"}},[e._v("Query Store"),a("OutboundLink")],1),e._v(" feature, which is disabled by default.")]),e._v(" "),a("p",[e._v("You can enable the Query Store feature in the "),a("strong",[e._v("Server parameters")]),e._v(" blade of the Azure Database for PostgreSQL database. In there, you need to set the "),a("strong",[e._v("pg_qs.query_capture_mode")]),e._v(" parameter to "),a("strong",[e._v("ALL")]),e._v(" and save the changes.")]),e._v(" "),a("img",{attrs:{src:e.$withBase("/files/98querystore.png")}}),e._v(" "),a("p",[e._v("(Enable the Query Store feature)")]),e._v(" "),a("p",[e._v("After 20 minutes or so, query statistics will show up in the "),a("strong",[e._v("Query Performance Insight")]),e._v(" blade of the database.")]),e._v(" "),a("img",{attrs:{src:e.$withBase("/files/98querystore2.png")}}),e._v(" "),a("p",[e._v("(The Query Performance Insight blade)")]),e._v(" "),a("h4",{attrs:{id:"conclusion"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#conclusion"}},[e._v("#")]),e._v(" Conclusion")]),e._v(" "),a("p",[a("a",{attrs:{href:"https://docs.microsoft.com/azure/postgresql/overview?WT.mc_id=docs-azuredevtips-azureappsdev",target:"_blank",rel:"noopener noreferrer"}},[e._v("Azure Database for PostgreSQL"),a("OutboundLink")],1),e._v(" provides a scalable, highly available, secure and performant version of PostgreSQL. And when you use "),a("a",{attrs:{href:"https://docs.microsoft.com/azure/postgresql/application-best-practices#configuration-of-application-and-database-resources?WT.mc_id=docs-azuredevtips-azureappsdev",target:"_blank",rel:"noopener noreferrer"}},[e._v("best practices"),a("OutboundLink")],1),e._v(", like optimized "),a("a",{attrs:{href:"https://docs.microsoft.com/azure/postgresql/concepts-security?WT.mc_id=docs-azuredevtips-azureappsdev",target:"_blank",rel:"noopener noreferrer"}},[e._v("server security"),a("OutboundLink")],1),e._v(", "),a("a",{attrs:{href:"https://docs.microsoft.com/azure/app-service/configure-common#configure-app-settings?WT.mc_id=docs-azuredevtips-azureappsdev",target:"_blank",rel:"noopener noreferrer"}},[e._v("not storing connection strings in code"),a("OutboundLink")],1),e._v(", use "),a("a",{attrs:{href:"https://docs.microsoft.com/azure/postgresql/concepts-read-replicas?WT.mc_id=docs-azuredevtips-azureappsdev",target:"_blank",rel:"noopener noreferrer"}},[e._v("read replications"),a("OutboundLink")],1),e._v(", enable "),a("a",{attrs:{href:"https://docs.microsoft.com/azure/postgresql/howto-optimize-autovacuum?WT.mc_id=docs-azuredevtips-azureappsdev",target:"_blank",rel:"noopener noreferrer"}},[e._v("autovacuum"),a("OutboundLink")],1),e._v(", and use the "),a("a",{attrs:{href:"https://docs.microsoft.com/azure/postgresql/concepts-query-store?WT.mc_id=docs-azuredevtips-azureappsdev",target:"_blank",rel:"noopener noreferrer"}},[e._v("Query Store"),a("OutboundLink")],1),e._v(" feature, you make sure that your application will perform at its best and will stay available and secure. Go and check it out!")])])}),[],!1,null,null,null);r.default=o.exports}}]);