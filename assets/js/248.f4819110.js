(window.webpackJsonp=window.webpackJsonp||[]).push([[248],{688:function(e,r,t){"use strict";t.r(r);var a=t(69),n=Object(a.a)({},(function(){var e=this,r=e.$createElement,t=e._self._c||r;return t("ContentSlotsDistributor",{attrs:{"slot-key":e.$parent.slotKey}},[t("div",{staticClass:"custom-block tip"},[t("p",{staticClass:"custom-block-title"},[e._v("TIP")]),e._v(" "),t("p",[e._v("ðŸ”¥  Download the FREE Azure Developer Guide eBook "),t("a",{attrs:{href:"http://aka.ms/azuredevebook?WT.mc_id=docs-azuredevtips-azureappsdev",target:"_blank",rel:"noopener noreferrer"}},[e._v("here"),t("OutboundLink")],1),e._v(".")]),e._v(" "),t("p",[e._v("ðŸ’¡ Learn more : "),t("a",{attrs:{href:"https://docs.microsoft.com/azure/azure-sql/managed-instance/sql-managed-instance-paas-overview?WT.mc_id=docs-azuredevtips-azureappsdev",target:"_blank",rel:"noopener noreferrer"}},[e._v("What is Azure SQL Managed Instance?"),t("OutboundLink")],1),e._v(".")]),e._v(" "),t("p",[e._v("ðŸ“º Watch the video : "),t("a",{attrs:{href:"https://youtu.be/n4UkJWD14Pk?WT.mc_id=youtube-azuredevtips-azureappsdev",target:"_blank",rel:"noopener noreferrer"}},[e._v("How to enable Azure SQL managed instance in Azure Arc - Part 3"),t("OutboundLink")],1),e._v(".")])]),e._v(" "),t("h3",{attrs:{id:"how-to-enable-azure-sql-managed-instance-in-azure-arc-part-3"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#how-to-enable-azure-sql-managed-instance-in-azure-arc-part-3"}},[e._v("#")]),e._v(" How to enable Azure SQL managed instance in Azure Arc - Part 3")]),e._v(" "),t("h4",{attrs:{id:"full-control-over-a-paas-enabled-sql-server"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#full-control-over-a-paas-enabled-sql-server"}},[e._v("#")]),e._v(" Full control over a PaaS-enabled SQL Server")]),e._v(" "),t("p",[t("a",{attrs:{href:"https://docs.microsoft.com/azure/azure-sql/managed-instance/sql-managed-instance-paas-overview?WT.mc_id=docs-azuredevtips-azureappsdev",target:"_blank",rel:"noopener noreferrer"}},[e._v("Azure SQL Managed Instance"),t("OutboundLink")],1),e._v(" allows you to run SQL Server in your control, enabling you to adhere to your security and policy requirements. It also provides PaaS features like automatic patching and version updates, "),t("a",{attrs:{href:"https://docs.microsoft.com/azure/azure-sql/database/automated-backups-overview?WT.mc_id=docs-azuredevtips-azureappsdev",target:"_blank",rel:"noopener noreferrer"}},[e._v("automated backups"),t("OutboundLink")],1),e._v(" and "),t("a",{attrs:{href:"https://docs.microsoft.com/azure/azure-sql/database/high-availability-sla?WT.mc_id=docs-azuredevtips-azureappsdev",target:"_blank",rel:"noopener noreferrer"}},[e._v("high availability"),t("OutboundLink")],1),e._v(", which make management easy.")]),e._v(" "),t("p",[e._v("Azure Arc-enabled SQL Managed Instance allows you to run your SQL Managed instance anywhere. All you need is a an "),t("a",{attrs:{href:"https://docs.microsoft.com/azure/azure-arc/kubernetes/overview?WT.mc_id=docs-azuredevtips-azureappsdev",target:"_blank",rel:"noopener noreferrer"}},[e._v("Azure Arc-enabled Kubernetes"),t("OutboundLink")],1),e._v(" cluster with a "),t("a",{attrs:{href:"https://docs.microsoft.com/azure/azure-arc/data/create-data-controller?WT.mc_id=docs-azuredevtips-azureappsdev",target:"_blank",rel:"noopener noreferrer"}},[e._v("data controller"),t("OutboundLink")],1),e._v(" in it.")]),e._v(" "),t("p",[e._v("In this third part of the three-part Azure Arc series, we'll use the "),t("a",{attrs:{href:"https://docs.microsoft.com/azure/azure-arc/kubernetes/overview?WT.mc_id=docs-azuredevtips-azureappsdev",target:"_blank",rel:"noopener noreferrer"}},[e._v("Arc-enabled Kubernetes"),t("OutboundLink")],1),e._v(" cluster to create a data controller and host a SQL Managed Instance in it.")]),e._v(" "),t("h4",{attrs:{id:"prerequisites"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#prerequisites"}},[e._v("#")]),e._v(" Prerequisites")]),e._v(" "),t("p",[e._v("If you want to follow along, you'll need the following:")]),e._v(" "),t("ul",[t("li",[e._v("An Azure subscription (If you don't have an Azure subscription, create a "),t("a",{attrs:{href:"https://azure.microsoft.com/free/?WT.mc_id=azure-azuredevtips-azureappsdev",target:"_blank",rel:"noopener noreferrer"}},[e._v("free account"),t("OutboundLink")],1),e._v(" before you begin)")]),e._v(" "),t("li",[e._v("You need to have an Arc-enabled server, with an Arc-enabled Kubernetes cluster. You can follow "),t("a",{attrs:{href:"https://microsoft.github.io/AzureTipsAndTricks/blog/tip343.html?WT.mc_id=azure-azuredevtips-azureappsdev",target:"_blank",rel:"noopener noreferrer"}},[e._v("part 1"),t("OutboundLink")],1),e._v(" and "),t("a",{attrs:{href:"https://microsoft.github.io/AzureTipsAndTricks/blog/tip344.html?WT.mc_id=azure-azuredevtips-azureappsdev",target:"_blank",rel:"noopener noreferrer"}},[e._v("part 2 of this series of posts"),t("OutboundLink")],1),e._v(" to get started.")])]),e._v(" "),t("h4",{attrs:{id:"create-an-azure-arc-enabled-sql-managed-instance"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#create-an-azure-arc-enabled-sql-managed-instance"}},[e._v("#")]),e._v(" Create an Azure Arc-enabled SQL Managed Instance")]),e._v(" "),t("p",[e._v("Before we can deploy data services, like a SQL Managed Instance, we need to create an Azure Arc data controller in the Arc-enabled Kubernetes.")]),e._v(" "),t("ol",[t("li",[e._v("First we need to create an "),t("a",{attrs:{href:"https://docs.microsoft.com/azure/azure-arc/data/upload-metrics-and-logs-to-azure-monitor?pivots=client-operating-system-macos-and-linux&WT.mc_id=docs-azuredevtips-azureappsdev#create-service-principal",target:"_blank",rel:"noopener noreferrer"}},[e._v("Azure Service Principal"),t("OutboundLink")],1),e._v(" that the data controller uses to send metrics to Azure Monitor. Run the script below in the "),t("a",{attrs:{href:"http://shell.azure.com/?WT.mc_id=azure-azuredevtips-azureappsdev",target:"_blank",rel:"noopener noreferrer"}},[e._v("Azure Cloud Shell"),t("OutboundLink")],1),e._v(" to create the service principal, and replace "),t("strong",[e._v("{ServicePrincipalName}")]),e._v(", "),t("strong",[e._v("{SubscriptionId}")]),e._v(", and "),t("strong",[e._v("{resourcegroup}")]),e._v(". Make sure to save the details of the Service Principal when it is created")])]),e._v(" "),t("div",{staticClass:"language- line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[e._v("az ad sp create-for-rbac --name {ServicePrincipalName} --role Contributor --scopes /subscriptions/{SubscriptionId}/resourceGroups/{resourcegroup}\n")])]),e._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[e._v("1")]),t("br")])]),t("ol",{attrs:{start:"2"}},[t("li",[e._v("Now assign a role to the service principal. Replace "),t("strong",[e._v("{appId}")]),e._v(", "),t("strong",[e._v("{SubscriptionID}")]),e._v(", and "),t("strong",[e._v("{resourcegroup}")]),e._v(".")])]),e._v(" "),t("div",{staticClass:"language- line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[e._v("az role assignment create --assignee {appId} --role 'Monitoring Metrics Publisher' --scope subscriptions/{SubscriptionID}/resourceGroups/{resourcegroup}\n")])]),e._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[e._v("1")]),t("br")])]),t("ol",{attrs:{start:"3"}},[t("li",[e._v("Next, go to the "),t("a",{attrs:{href:"https://portal.azure.com/?WT.mc_id=azure-azuredevtips-azureappsdev",target:"_blank",rel:"noopener noreferrer"}},[e._v("Azure portal"),t("OutboundLink")],1)]),e._v(" "),t("li",[e._v("Search for "),t("strong",[e._v('"Azure Arc"')]),e._v(" in the search box and click on the result. You will now see the Azure Arc overview blade")]),e._v(" "),t("li",[e._v("Navigate to the "),t("strong",[e._v("Kubernetes clusters")]),e._v(" menu")]),e._v(" "),t("li",[e._v("You'll see the connected Kubernetes cluster. Click on it")]),e._v(" "),t("li",[e._v("Click on the "),t("strong",[e._v("Extensions")]),e._v(" menu")]),e._v(" "),t("li",[e._v("Click "),t("strong",[e._v("Add")])]),e._v(" "),t("li",[e._v("Select "),t("strong",[e._v("Azure Arc data controller")]),e._v(", and click "),t("strong",[e._v("Create")]),e._v(". We need this to enable Azure Arc data services")]),e._v(" "),t("li",[e._v("Fill in a "),t("strong",[e._v("name")]),e._v(" for the data controller")]),e._v(" "),t("li",[e._v("Create a new "),t("strong",[e._v("Custom location")]),e._v(" by filling in a "),t("strong",[e._v("Name")]),e._v(" and "),t("strong",[e._v("Namespace")]),e._v(". We'll use this later to deploy the SQL Managed Instance")]),e._v(" "),t("li",[e._v("Select the "),t("strong",[e._v("Kubernetes configuration template")]),e._v(" that best resembles your Kubernetes cluster")]),e._v(" "),t("li",[e._v("Pick the network "),t("strong",[e._v("Service Type")])]),e._v(" "),t("li",[e._v("Fill in a data controller "),t("strong",[e._v("Login")]),e._v(" and "),t("strong",[e._v("Password")]),e._v(". You need these when you want to log into the data controller from other applications, like "),t("a",{attrs:{href:"https://docs.microsoft.com/sql/azure-data-studio/what-is-azure-data-studio?WT.mc_id=docs-azuredevtips-azureappsdev",target:"_blank",rel:"noopener noreferrer"}},[e._v("Azure Data Studio"),t("OutboundLink")],1)]),e._v(" "),t("li",[e._v("Fill in the details of the "),t("strong",[e._v("Service Principal")]),e._v(" that we created earlier")]),e._v(" "),t("li",[e._v("Click "),t("strong",[e._v("Next: Additional Settings")])])]),e._v(" "),t("img",{attrs:{src:e.$withBase("/files/129createcontroller.png")}}),e._v(" "),t("p",[e._v("(Create Azure Arc data controller)")]),e._v(" "),t("ol",{attrs:{start:"15"}},[t("li",[e._v("Uncheck the "),t("strong",[e._v('"Enable logs upload"')]),e._v(" setting")]),e._v(" "),t("li",[e._v("Click "),t("strong",[e._v("Next: Tags")])]),e._v(" "),t("li",[e._v("Select "),t("strong",[e._v("Next: Review + Create")]),e._v(", and then "),t("strong",[e._v("Create")])])]),e._v(" "),t("p",[e._v("After creating the data controller, you'll find it in the Azure Arc resource in the Azure portal. And in the Custom locations menu, you'll find the location it created.")]),e._v(" "),t("img",{attrs:{src:e.$withBase("/files/129customloc.png")}}),e._v(" "),t("p",[e._v("(Azure Arc Custom location)")]),e._v(" "),t("p",[e._v("Next, we can create an Arc-enabled SQL Managed Instance.")]),e._v(" "),t("ol",[t("li",[e._v("In the Arc resource in the Azure portal, navigate to the "),t("strong",[e._v("SQL Managed Instances")]),e._v(" menu")]),e._v(" "),t("li",[e._v("Click "),t("strong",[e._v("Create")])]),e._v(" "),t("li",[e._v("Select the "),t("strong",[e._v("Resource group")]),e._v(" that contains the Arc-enabled Kubernetes cluster")]),e._v(" "),t("li",[e._v("Pick the "),t("strong",[e._v("Custom location")]),e._v(" that the data controller created")]),e._v(" "),t("li",[e._v("For "),t("strong",[e._v("Service type")]),e._v(", select LoadBalancer")]),e._v(" "),t("li",[e._v("Fill in the "),t("strong",[e._v("credentials")]),e._v(" for the Managed Instance with the "),t("strong",[e._v("Login")]),e._v(" and "),t("strong",[e._v("Password")]),e._v(". You'll need these to log into the SQL Managed Instance")]),e._v(" "),t("li",[e._v("Click "),t("strong",[e._v("Review + Create")]),e._v(" and then "),t("strong",[e._v("Create")])])]),e._v(" "),t("img",{attrs:{src:e.$withBase("/files/129createmanagedinstance.png")}}),e._v(" "),t("p",[e._v("(Create an Arc-enabled SQL Managed Instance)")]),e._v(" "),t("p",[e._v("It can take a few minutes to create the Managed Instance. When it's done, you can find it through the Azure Arc resource in the Azure portal. Or in the list of SQL Managed Instances, where it looks and behaves just like other SQL Managed Instances. The only difference is that it runs on an Arc-enabled Kubernetes cluster that runs on my local machine.")]),e._v(" "),t("img",{attrs:{src:e.$withBase("/files/129result.png")}}),e._v(" "),t("p",[e._v("(The Arc-enabled SQL Managed Instance in the Azure portal)")]),e._v(" "),t("h4",{attrs:{id:"conclusion"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#conclusion"}},[e._v("#")]),e._v(" Conclusion")]),e._v(" "),t("p",[e._v("Azure Arc enables you to run managed Azure services anywhere, including data services like "),t("a",{attrs:{href:"https://docs.microsoft.com/azure/azure-arc/data/managed-instance-overview?WT.mc_id=docs-azuredevtips-azureappsdev",target:"_blank",rel:"noopener noreferrer"}},[e._v("Azure SQL Managed Instance"),t("OutboundLink")],1),e._v(", on an "),t("a",{attrs:{href:"https://docs.microsoft.com/azure/azure-arc/kubernetes/overview?WT.mc_id=docs-azuredevtips-azureappsdev",target:"_blank",rel:"noopener noreferrer"}},[e._v("Arc-enabled Kubernetes cluster"),t("OutboundLink")],1),e._v(". Go and check it out!")])])}),[],!1,null,null,null);r.default=n.exports}}]);