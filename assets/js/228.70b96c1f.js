(window.webpackJsonp=window.webpackJsonp||[]).push([[228],{664:function(e,t,r){"use strict";r.r(t);var s=r(69),a=Object(s.a)({},(function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("ContentSlotsDistributor",{attrs:{"slot-key":e.$parent.slotKey}},[r("div",{staticClass:"custom-block tip"},[r("p",{staticClass:"custom-block-title"},[e._v("TIP")]),e._v(" "),r("p",[e._v("ðŸ”¥ Checkout the Azure Developer page at "),r("a",{attrs:{href:"https://azure.com/developer?WT.mc_id=azure-azuredevtips-azureappsdev",target:"_blank",rel:"noopener noreferrer"}},[e._v("azure.com/developer"),r("OutboundLink")],1),e._v(".")]),e._v(" "),r("p",[e._v("ðŸ’¡ Learn more : "),r("a",{attrs:{href:"https://docs.microsoft.com/azure/aks/intro-kubernetes?WT.mc_id=docs-azuredevtips-azureappsdev",target:"_blank",rel:"noopener noreferrer"}},[e._v("Azure Kubernetes Service overview"),r("OutboundLink")],1),e._v(".")]),e._v(" "),r("p",[e._v("ðŸ“º Watch the video : "),r("a",{attrs:{href:"https://youtu.be/0f3lo56h4tg?WT.mc_id=youtube-azuredevtips-azureappsdev",target:"_blank",rel:"noopener noreferrer"}},[e._v("How to start and stop Azure Kubernetes clusters"),r("OutboundLink")],1),e._v(".")])]),e._v(" "),r("h3",{attrs:{id:"how-to-start-and-stop-azure-kubernetes-clusters"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#how-to-start-and-stop-azure-kubernetes-clusters"}},[e._v("#")]),e._v(" How to start and stop Azure Kubernetes clusters")]),e._v(" "),r("h4",{attrs:{id:"save-costs-by-stopping-an-azure-kubernetes-service-cluster"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#save-costs-by-stopping-an-azure-kubernetes-service-cluster"}},[e._v("#")]),e._v(" Save costs by stopping an Azure Kubernetes Service cluster")]),e._v(" "),r("p",[e._v("Running multiple containers in an "),r("a",{attrs:{href:"https://docs.microsoft.com/azure/aks/intro-kubernetes?WT.mc_id=docs-azuredevtips-azureappsdev",target:"_blank",rel:"noopener noreferrer"}},[e._v("Azure Kubernetes Service cluster"),r("OutboundLink")],1),e._v(" can be expensive and might not be necessary all the time, if your application isn't used continuously. To save costs, you could scale down your user node pools to zero, but your system pool still needs to run. Now, you can stop your entire Azure Kubernetes Service cluster to save costs. When it is stopped, the state of your objects and cluster configuration remains saved, allowing you to restore everything when you start the cluster again.")]),e._v(" "),r("p",[e._v("In this post, we'll stop and start an Azure Kubernetes Service cluster.")]),e._v(" "),r("h4",{attrs:{id:"prerequisites"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#prerequisites"}},[e._v("#")]),e._v(" Prerequisites")]),e._v(" "),r("p",[e._v("If you want to follow along, you'll need the following:")]),e._v(" "),r("ul",[r("li",[e._v("An Azure subscription (If you don't have an Azure subscription, create a "),r("a",{attrs:{href:"https://azure.microsoft.com/free/?WT.mc_id=azure-azuredevtips-azureappsdev",target:"_blank",rel:"noopener noreferrer"}},[e._v("free account"),r("OutboundLink")],1),e._v(" before you begin)")]),e._v(" "),r("li",[e._v("An Azure Kubernetes Cluster. Create one "),r("a",{attrs:{href:"https://docs.microsoft.com/azure/aks/kubernetes-walkthrough-portal?WT.mc_id=docs-azuredevtips-azureappsdev",target:"_blank",rel:"noopener noreferrer"}},[e._v("using this quickstart"),r("OutboundLink")],1)]),e._v(" "),r("li",[e._v("The "),r("a",{attrs:{href:"https://docs.microsoft.com/cli/azure/?WT.mc_id=docs-azuredevtips-azureappsdev",target:"_blank",rel:"noopener noreferrer"}},[e._v("Azure CLI"),r("OutboundLink")],1),e._v(". You can "),r("a",{attrs:{href:"https://docs.microsoft.com/cli/azure/install-azure-cli?WT.mc_id=docs-azuredevtips-azureappsdev",target:"_blank",rel:"noopener noreferrer"}},[e._v("download it for Windows, Linux or Mac"),r("OutboundLink")],1)])]),e._v(" "),r("h4",{attrs:{id:"stop-and-start-an-azure-kubernetes-service-cluster"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#stop-and-start-an-azure-kubernetes-service-cluster"}},[e._v("#")]),e._v(" Stop and start an Azure Kubernetes Service cluster")]),e._v(" "),r("p",[e._v("Let's use the Azure CLI to stop and start a Kubernetes Service Cluster. We'll start with an existing cluster that is currently in a running state.")]),e._v(" "),r("img",{attrs:{src:e.$withBase("/files/92clusteroverview.png")}}),e._v(" "),r("p",[e._v("(Feature in registering state)")]),e._v(" "),r("ol",[r("li",[e._v("Open a "),r("strong",[e._v("command prompt")])]),e._v(" "),r("li",[e._v("To start and stop an AKS cluster, we need the "),r("strong",[e._v("aks-preview extension")]),e._v(" for the Azure CLI. Run the following commands to install it and to make sure that you have the latest version:")])]),e._v(" "),r("div",{staticClass:"language- line-numbers-mode"},[r("pre",{pre:!0,attrs:{class:"language-text"}},[r("code",[e._v("# Install the aks-preview extension\naz extension add --name aks-preview\n\n# Update the extension to make sure you have the latest version installed\naz extension update --name aks-preview\n")])]),e._v(" "),r("div",{staticClass:"line-numbers-wrapper"},[r("span",{staticClass:"line-number"},[e._v("1")]),r("br"),r("span",{staticClass:"line-number"},[e._v("2")]),r("br"),r("span",{staticClass:"line-number"},[e._v("3")]),r("br"),r("span",{staticClass:"line-number"},[e._v("4")]),r("br"),r("span",{staticClass:"line-number"},[e._v("5")]),r("br")])]),r("ol",{attrs:{start:"3"}},[r("li",[e._v("We also need to enable the StartStopPreview feature flag on your subscription with this command:")])]),e._v(" "),r("div",{staticClass:"language- line-numbers-mode"},[r("pre",{pre:!0,attrs:{class:"language-text"}},[r("code",[e._v('az feature register --namespace "Microsoft.ContainerService" --name "StartStopPreview"\n')])]),e._v(" "),r("div",{staticClass:"line-numbers-wrapper"},[r("span",{staticClass:"line-number"},[e._v("1")]),r("br")])]),r("ol",{attrs:{start:"4"}},[r("li",[e._v("Wait until the feature is registered. You can check if it is with this command:")])]),e._v(" "),r("div",{staticClass:"language- line-numbers-mode"},[r("pre",{pre:!0,attrs:{class:"language-text"}},[r("code",[e._v("az feature list -o table --query \"[?contains(name, 'Microsoft.ContainerService/StartStopPreview')].{Name:name,State:properties.state}\"\n")])]),e._v(" "),r("div",{staticClass:"line-numbers-wrapper"},[r("span",{staticClass:"line-number"},[e._v("1")]),r("br")])]),r("img",{attrs:{src:e.$withBase("/files/92registerpreview.png")}}),e._v(" "),r("p",[e._v("(Feature in registering state)")]),e._v(" "),r("ol",{attrs:{start:"5"}},[r("li",[e._v("When the feature is registered, refresh the registration for the Microsoft.ContainerService resource provider with this command:")])]),e._v(" "),r("div",{staticClass:"language- line-numbers-mode"},[r("pre",{pre:!0,attrs:{class:"language-text"}},[r("code",[e._v("az provider register --namespace Microsoft.ContainerService\n")])]),e._v(" "),r("div",{staticClass:"line-numbers-wrapper"},[r("span",{staticClass:"line-number"},[e._v("1")]),r("br")])]),r("ol",{attrs:{start:"6"}},[r("li",[e._v("Alright, let's stop our ASK cluster. You can stop a cluster with this command, where you fill in the name of your AKS cluster and the resource group of the cluster:")])]),e._v(" "),r("div",{staticClass:"language- line-numbers-mode"},[r("pre",{pre:!0,attrs:{class:"language-text"}},[r("code",[e._v("az aks stop --name myAKSCluster --resource-group myResourceGroup\n")])]),e._v(" "),r("div",{staticClass:"line-numbers-wrapper"},[r("span",{staticClass:"line-number"},[e._v("1")]),r("br")])]),r("ol",{attrs:{start:"7"}},[r("li",[e._v("When the cluster is stopped, you can check to see if it is, by running the following command:")])]),e._v(" "),r("div",{staticClass:"language- line-numbers-mode"},[r("pre",{pre:!0,attrs:{class:"language-text"}},[r("code",[e._v("az aks show --name myAKSCluster --resource-group myResourceGroup\n")])]),e._v(" "),r("div",{staticClass:"line-numbers-wrapper"},[r("span",{staticClass:"line-number"},[e._v("1")]),r("br")])]),r("p",[e._v("In the JSON that follows, you can see the status of the cluster by looking at the "),r("strong",[e._v("powerState")]),e._v(", which will show "),r("strong",[e._v("Stopped")]),e._v(".")]),e._v(" "),r("img",{attrs:{src:e.$withBase("/files/92stopped.png")}}),e._v(" "),r("p",[e._v("(Stopped state)")]),e._v(" "),r("ol",{attrs:{start:"8"}},[r("li",[e._v("You can easily start the cluster again with the this command:")])]),e._v(" "),r("div",{staticClass:"language- line-numbers-mode"},[r("pre",{pre:!0,attrs:{class:"language-text"}},[r("code",[e._v("az aks start --name myAKSCluster --resource-group myResourceGroup\n")])]),e._v(" "),r("div",{staticClass:"line-numbers-wrapper"},[r("span",{staticClass:"line-number"},[e._v("1")]),r("br")])]),r("h4",{attrs:{id:"conclusion"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#conclusion"}},[e._v("#")]),e._v(" Conclusion")]),e._v(" "),r("p",[e._v("Stopping an "),r("a",{attrs:{href:"https://docs.microsoft.com/azure/aks/intro-kubernetes?WT.mc_id=docs-azuredevtips-azureappsdev",target:"_blank",rel:"noopener noreferrer"}},[e._v("Azure Kubernetes Service cluster"),r("OutboundLink")],1),e._v(" is a great way to save money. You can easily start and stop AKS with an "),r("a",{attrs:{href:"https://docs.microsoft.com/cli/azure/?WT.mc_id=docs-azuredevtips-azureappsdev",target:"_blank",rel:"noopener noreferrer"}},[e._v("Azure CLI"),r("OutboundLink")],1),e._v(" command, which you can, for instance, "),r("a",{attrs:{href:"https://docs.microsoft.com/azure/automation/automation-intro?WT.mc_id=docs-azuredevtips-azureappsdev",target:"_blank",rel:"noopener noreferrer"}},[e._v("automate"),r("OutboundLink")],1),e._v(" to stop when the service isn't used and start during business hours. Go and check it out!")])])}),[],!1,null,null,null);t.default=a.exports}}]);