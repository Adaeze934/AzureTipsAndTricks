(window.webpackJsonp=window.webpackJsonp||[]).push([[273],{630:function(e,t,r){"use strict";r.r(t);var n=r(43),s=Object(n.a)({},(function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("ContentSlotsDistributor",{attrs:{"slot-key":e.$parent.slotKey}},[r("div",{staticClass:"custom-block tip"},[r("p",{staticClass:"custom-block-title"},[e._v("TIP")]),e._v(" "),r("p",[e._v("ðŸ”¥  Download the FREE Azure Developer Guide eBook "),r("a",{attrs:{href:"http://aka.ms/azuredevebook?WT.mc_id=docs-azuredevtips-azureappsdev",target:"_blank",rel:"noopener noreferrer"}},[e._v("here"),r("OutboundLink")],1),e._v(".")]),e._v(" "),r("p",[e._v("ðŸ’¡ Learn more : "),r("a",{attrs:{href:"https://docs.microsoft.com/azure/security-center/security-center-introduction?WT.mc_id=docs-azuredevtips-azureappsdev",target:"_blank",rel:"noopener noreferrer"}},[e._v("Azure Security Center overview"),r("OutboundLink")],1),e._v(".")]),e._v(" "),r("p",[e._v("ðŸ“º Watch the video : "),r("a",{attrs:{href:"https://youtu.be/UYS10QA6diQ?WT.mc_id=youtube-azuredevtips-azureappsdev",target:"_blank",rel:"noopener noreferrer"}},[e._v("How to connect GitHub Actions to Azure Security Center"),r("OutboundLink")],1),e._v(".")])]),e._v(" "),r("h3",{attrs:{id:"how-to-connect-github-actions-to-azure-security-center"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#how-to-connect-github-actions-to-azure-security-center"}},[e._v("#")]),e._v(" How to connect GitHub Actions to Azure Security Center")]),e._v(" "),r("h4",{attrs:{id:"integrate-security-in-your-devops-practices"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#integrate-security-in-your-devops-practices"}},[e._v("#")]),e._v(" Integrate security in your DevOps practices")]),e._v(" "),r("p",[e._v("Many companies have adopted DevOps practices, which enable them to automatically build, test and release software. This increases software quality and innovation, as it eliminates human error, and promotes practices like Infrastructure-as-Code (IaC), and container usage. The latter makes things easier by running your applications on the same infrastructure in development, test, and production environments. DevOps is essential, but often lacks integrated security practices. That is where "),r("a",{attrs:{href:"https://docs.microsoft.com/azure/security-center/security-center-introduction?WT.mc_id=docs-azuredevtips-azureappsdev",target:"_blank",rel:"noopener noreferrer"}},[e._v("Azure Security Center"),r("OutboundLink")],1),e._v(" comes in.")]),e._v(" "),r("p",[e._v("Azure Security Center is an infrastructure security management system that provides advanced threat protection. And now, you can integrate Azure Security Center into your "),r("a",{attrs:{href:"https://github.com/features/actions?WT.mc_id=github-azuredevtips-azureappsdev",target:"_blank",rel:"noopener noreferrer"}},[e._v("GitHub Actions"),r("OutboundLink")],1),e._v(" DevOps process. In this post, we'll explore how to integrate Azure Security Center into GitHub Actions to secure a DevOps pipeline.")]),e._v(" "),r("h4",{attrs:{id:"prerequisites"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#prerequisites"}},[e._v("#")]),e._v(" Prerequisites")]),e._v(" "),r("p",[e._v("If you want to follow along, you'll need the following:")]),e._v(" "),r("ul",[r("li",[e._v("An Azure subscription (If you don't have an Azure subscription, create a "),r("a",{attrs:{href:"https://azure.microsoft.com/free/?WT.mc_id=azure-azuredevtips-azureappsdev",target:"_blank",rel:"noopener noreferrer"}},[e._v("free account"),r("OutboundLink")],1),e._v(" before you begin)")]),e._v(" "),r("li",[e._v("A GitHub account. Create one "),r("a",{attrs:{href:"https://www.github.com/join?WT.mc_id=github-azuredevtips-azureappsdev",target:"_blank",rel:"noopener noreferrer"}},[e._v("here for free"),r("OutboundLink")],1)]),e._v(" "),r("li",[e._v("A GitHub repository with a containerized ASP.NET application")]),e._v(" "),r("li",[e._v("Access to an "),r("a",{attrs:{href:"https://azure.microsoft.com/services/container-registry/?WT.mc_id=azure-azuredevtips-azureappsdev",target:"_blank",rel:"noopener noreferrer"}},[e._v("Azure Container Registry"),r("OutboundLink")],1),e._v(". Check out "),r("a",{attrs:{href:"https://microsoft.github.io/AzureTipsAndTricks/blog/tip312.html?WT.mc_id=github-azuredevtips-azureappsdev",target:"_blank",rel:"noopener noreferrer"}},[e._v("Azure Tips and Tricks Tip 312"),r("OutboundLink")],1),e._v(" to learn how to create an Azure Container Registry")])]),e._v(" "),r("h4",{attrs:{id:"integrate-azure-security-center-into-github-actions"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#integrate-azure-security-center-into-github-actions"}},[e._v("#")]),e._v(" Integrate Azure Security Center into GitHub Actions")]),e._v(" "),r("p",[e._v("We'll use a sample ASP.NET application that has a Docker file, to build a container and push it to Azure Container Registry. From there, the container can be deployed to any service that can run it. In GitHub, we'll create a GitHub Action to build the container, scan it for security vulnerabilities, and send the log results to Application Insights, which is connected to Azure Security Center. And first, we'll need the integration information from Azure Security Center.")]),e._v(" "),r("ol",[r("li",[e._v("Go to the "),r("a",{attrs:{href:"https://portal.azure.com/?WT.mc_id=azure-azuredevtips-azureappsdev",target:"_blank",rel:"noopener noreferrer"}},[e._v("Azure portal"),r("OutboundLink")],1)]),e._v(" "),r("li",[e._v("Search for "),r("strong",[e._v("Azure Security Center")]),e._v(" in the search box and click on the result. This will take you to your Azure Security Center")]),e._v(" "),r("li",[e._v("Navigate to the "),r("strong",[e._v("Pricing & settings")]),e._v(" menu")]),e._v(" "),r("li",[e._v("Select your "),r("strong",[e._v("subscription")])]),e._v(" "),r("li",[e._v("Click on "),r("strong",[e._v("Azure Defender Plans")])]),e._v(" "),r("li",[e._v("Make sure that "),r("strong",[e._v("Container registries")]),e._v(" is "),r("strong",[e._v("enabled")]),e._v(". This allows Azure Defender to scan containers in Azure Container Registry")])]),e._v(" "),r("img",{attrs:{src:e.$withBase("/files/125defender.png")}}),e._v(" "),r("p",[e._v("(Enable Azure Defender for Container registries)")]),e._v(" "),r("ol",{attrs:{start:"7"}},[r("li",[e._v("Click on "),r("strong",[e._v("Integrations")])]),e._v(" "),r("li",[e._v("Select "),r("strong",[e._v("Configure CI/CD integration")])]),e._v(" "),r("li",[e._v("Copy the "),r("strong",[e._v("Authentication token")]),e._v(" and "),r("strong",[e._v("Connection string")]),e._v(". We'll use this to send security scan information to the Application Insights workspace that is connected to Azure Security Center")])]),e._v(" "),r("img",{attrs:{src:e.$withBase("/files/125ascconfig.png")}}),e._v(" "),r("p",[e._v("(Configure CI/CD integration in Azure Security Center)")]),e._v(" "),r("p",[e._v("Next, we need to create a GitHub Action that builds and pushes a container and scans it for security vulnerabilities.")]),e._v(" "),r("ol",[r("li",[e._v("Go to "),r("a",{attrs:{href:"https://github.com/?WT.mc_id=github-azuredevtips-azureappsdev",target:"_blank",rel:"noopener noreferrer"}},[e._v("GitHub"),r("OutboundLink")],1),e._v(" and open the repository with the containerized ASP.NET application")]),e._v(" "),r("li",[e._v("Navigate to the "),r("strong",[e._v("Actions")]),e._v(" menu")]),e._v(" "),r("li",[e._v("Click "),r("strong",[e._v("New workflow")])]),e._v(" "),r("li",[e._v("Select "),r("strong",[e._v('"set up a workflow yourself"')]),e._v(" to create a GitHub Action")])]),e._v(" "),r("img",{attrs:{src:e.$withBase("/files/125createaction.png")}}),e._v(" "),r("p",[e._v("(Create a new GitHub Action)")]),e._v(" "),r("ol",{attrs:{start:"5"}},[r("li",[e._v("In the "),r("strong",[e._v("main.yml")]),e._v(" file, paste the following code, and save and commit it")])]),e._v(" "),r("div",{staticClass:"language- line-numbers-mode"},[r("pre",{pre:!0,attrs:{class:"language-text"}},[r("code",[e._v("on: [push]\n\njobs:\n  build-secure-and-push:\n    runs-on: ubuntu-latest\n    steps:\n    - uses: actions/checkout@master\n\n    - run: docker build . -t ${{ secrets.ACR_NAME }}.azurecr.io/${{ secrets.ACR_REPOSITORY_NAME }}:${{ github.sha }}\n      \n    - uses: Azure/container-scan@v0\n      id: container-scan\n      continue-on-error: true\n      with:\n        image-name: ${{ secrets.ACR_NAME }}.azurecr.io/${{ secrets.ACR_REPOSITORY_NAME }}:${{ github.sha }}\n    \n    - uses: Azure/docker-login@v1\n      with:\n        login-server: ${{ secrets.ACR_NAME }}.azurecr.io\n        username: ${{ secrets.REGISTRY_USERNAME }}\n        password: ${{ secrets.REGISTRY_PASSWORD }}\n    \n    - run: docker push ${{ secrets.ACR_NAME }}.azurecr.io/${{ secrets.ACR_REPOSITORY_NAME }}:${{ github.sha }}       \n\n    - name: Post logs to appinsights\n      uses: Azure/publish-security-assessments@v0\n      with: \n        scan-results-path: ${{ steps.container-scan.outputs.scan-report-path }}\n        connection-string: ${{ secrets.AZ_APPINSIGHTS_CONNECTION_STRING }}\n        subscription-token: ${{ secrets.AZ_SUBSCRIPTION_TOKEN }}       \n                           \n")])]),e._v(" "),r("div",{staticClass:"line-numbers-wrapper"},[r("span",{staticClass:"line-number"},[e._v("1")]),r("br"),r("span",{staticClass:"line-number"},[e._v("2")]),r("br"),r("span",{staticClass:"line-number"},[e._v("3")]),r("br"),r("span",{staticClass:"line-number"},[e._v("4")]),r("br"),r("span",{staticClass:"line-number"},[e._v("5")]),r("br"),r("span",{staticClass:"line-number"},[e._v("6")]),r("br"),r("span",{staticClass:"line-number"},[e._v("7")]),r("br"),r("span",{staticClass:"line-number"},[e._v("8")]),r("br"),r("span",{staticClass:"line-number"},[e._v("9")]),r("br"),r("span",{staticClass:"line-number"},[e._v("10")]),r("br"),r("span",{staticClass:"line-number"},[e._v("11")]),r("br"),r("span",{staticClass:"line-number"},[e._v("12")]),r("br"),r("span",{staticClass:"line-number"},[e._v("13")]),r("br"),r("span",{staticClass:"line-number"},[e._v("14")]),r("br"),r("span",{staticClass:"line-number"},[e._v("15")]),r("br"),r("span",{staticClass:"line-number"},[e._v("16")]),r("br"),r("span",{staticClass:"line-number"},[e._v("17")]),r("br"),r("span",{staticClass:"line-number"},[e._v("18")]),r("br"),r("span",{staticClass:"line-number"},[e._v("19")]),r("br"),r("span",{staticClass:"line-number"},[e._v("20")]),r("br"),r("span",{staticClass:"line-number"},[e._v("21")]),r("br"),r("span",{staticClass:"line-number"},[e._v("22")]),r("br"),r("span",{staticClass:"line-number"},[e._v("23")]),r("br"),r("span",{staticClass:"line-number"},[e._v("24")]),r("br"),r("span",{staticClass:"line-number"},[e._v("25")]),r("br"),r("span",{staticClass:"line-number"},[e._v("26")]),r("br"),r("span",{staticClass:"line-number"},[e._v("27")]),r("br"),r("span",{staticClass:"line-number"},[e._v("28")]),r("br"),r("span",{staticClass:"line-number"},[e._v("29")]),r("br"),r("span",{staticClass:"line-number"},[e._v("30")]),r("br"),r("span",{staticClass:"line-number"},[e._v("31")]),r("br")])]),r("ol",{attrs:{start:"6"}},[r("li",[e._v("The main.yml contains placeholders for secrets. Go to the repository "),r("strong",[e._v("Settings")]),e._v(" menu")]),e._v(" "),r("li",[e._v("Click on the "),r("strong",[e._v("secrets")]),e._v(" menu")]),e._v(" "),r("li",[e._v("Add the following "),r("strong",[e._v("Repository secrets")]),e._v(":\n"),r("ol",[r("li",[e._v("name = ACR_NAME, value = The name of the Azure Container Registry, without azurecr.io")]),e._v(" "),r("li",[e._v("name = ACR_REPOSITORY_NAME, value = The repository name in Azure Container Registry to push the container to")]),e._v(" "),r("li",[e._v("name = REGISTRY_USERNAME, value = The admin username of the Azure Container Registry")]),e._v(" "),r("li",[e._v("name = REGISTRY_PASSWORD, value = The admin password of the Azure Container Registry")]),e._v(" "),r("li",[e._v("name = AZ_APPINSIGHTS_CONNECTION_STRING, value = The CI/CD integration Connection string that we copied from Azure Security Center")]),e._v(" "),r("li",[e._v("name = AZ_SUBSCRIPTION_TOKEN, value = The CI/CD integration Authentication token that we copied from Azure Security Center")])])]),e._v(" "),r("li",[e._v("Change something in the code repository and "),r("strong",[e._v("push it")]),e._v(". This will trigger the GitHub Action")]),e._v(" "),r("li",[e._v("Go to the Actions menu and drill down into the Action. You'll see the results of the security scan")])]),e._v(" "),r("p",[e._v("If the security scan found any vulnerabilities, these will show up as Azure Security Center recommendations when refreshed (Azure Security Center recommendations refresh every 24 hours). From there, you can apply remediations if they are available.")]),e._v(" "),r("img",{attrs:{src:e.$withBase("/files/125result.png")}}),e._v(" "),r("p",[e._v("(Container security recommendations in Azure Security Center)")]),e._v(" "),r("h4",{attrs:{id:"conclusion"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#conclusion"}},[e._v("#")]),e._v(" Conclusion")]),e._v(" "),r("p",[e._v("Security needs to be part of every process of software development, including DevOps processes. "),r("a",{attrs:{href:"https://docs.microsoft.com/azure/security-center/security-center-introduction?WT.mc_id=docs-azuredevtips-azureappsdev",target:"_blank",rel:"noopener noreferrer"}},[e._v("Azure Security Center"),r("OutboundLink")],1),e._v(" integrates with "),r("a",{attrs:{href:"https://github.com/features/actions?WT.mc_id=github-azuredevtips-azureappsdev",target:"_blank",rel:"noopener noreferrer"}},[e._v("GitHub actions"),r("OutboundLink")],1),e._v(" to scan containers for security vulnerabilities and report them as actionable recommendations. Go and check it out!")])])}),[],!1,null,null,null);t.default=s.exports}}]);