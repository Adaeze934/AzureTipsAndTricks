name: Create PR
on: [pull_request]

jobs:
 gitIssueCreation:
    name: Create Issue
    runs-on: ubuntu-latest
    steps:
    - name: Dump context
      uses: crazy-max/ghaction-dump-context@v1
        
        
    - uses: actions/checkout@v2
      name: Checkout Repo
      with:
        submodules: true
    - name: Install GH Cli
      run: |
        brew install gh
        
    - name: Clone Private repo
      run: |
        git clone "https://${{ secrets.PRIVATE_REPO_PAT  }}@github.com/microsoft/azuretipsandtricks-private.git" private
        cd private
        git checkout -b "pr-${{ github.event.number }}"
        cp -R "${{ github.workspace }}/blog" "${{ github.workspace }}/private/src/blog"
        cp "${{ github.workspace }}/.vuepress/public/files"  "${{ github.workspace }}/src/.vuepress/public/file"
        git add .
        git commit -m "${{ github.event.pull_request.title }}"
        git push origin "pr-${{ github.event.number }}"
        
    - name: GH CLI
      run: |      
        cd private   
        gh pr create --title "${{ github.event.pull_request.title }}"
      env:
        GITHUB_TOKEN: ${{ secrets.PRIVATE_REPO_PAT  }}
